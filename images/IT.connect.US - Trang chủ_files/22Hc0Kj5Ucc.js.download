if (self.CavalryLogger) { CavalryLogger.start_js(["BbYAg"]); }

__d("RealtimeEntityPresenceTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:RealtimeEntityPresenceLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:RealtimeEntityPresenceLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:RealtimeEntityPresenceLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAction=function(a){this.$1.action=a;return this};c.setActionReason=function(a){this.$1.action_reason=a;return this};c.setAppID=function(a){this.$1.app_id=a;return this};c.setCapabilities=function(a){this.$1.capabilities=a;return this};c.setClientSubscriptionID=function(a){this.$1.client_subscription_id=a;return this};c.setClientTimeMs=function(a){this.$1.client_time_ms=a;return this};c.setEntityHandler=function(a){this.$1.entity_handler=a;return this};c.setEntityID=function(a){this.$1.entity_id=a;return this};c.setEntityType=function(a){this.$1.entity_type=a;return this};c.setEventSource=function(a){this.$1.event_source=a;return this};c.setExceptionMessage=function(a){this.$1.exception_message=a;return this};c.setExceptionType=function(a){this.$1.exception_type=a;return this};c.setGatewayConnected=function(a){this.$1.gateway_connected=a;return this};c.setSequenceID=function(a){this.$1.sequence_id=a;return this};c.setSessionID=function(a){this.$1.session_id=a;return this};c.setSourceHost=function(a){this.$1.source_host=a;return this};c.setSourceTwTaskHandle=function(a){this.$1.source_tw_task_handle=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTopic=function(a){this.$1.topic=a;return this};c.setUserAgentString=function(a){this.$1.user_agent_string=a;return this};c.setUserFbid=function(a){this.$1.user_fbid=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};return a}();c={action:!0,action_reason:!0,app_id:!0,capabilities:!0,client_subscription_id:!0,client_time_ms:!0,entity_handler:!0,entity_id:!0,entity_type:!0,event_source:!0,exception_message:!0,exception_type:!0,gateway_connected:!0,sequence_id:!0,session_id:!0,source_host:!0,source_tw_task_handle:!0,time:!0,topic:!0,user_agent_string:!0,user_fbid:!0,weight:!0};e.exports=a}),null);
__d("EntityPresenceLogger",["BladeRunnerTypes","CurrentUser","EntityPresenceConfig","Random","RealtimeEntityPresenceTypedLogger","UserAgentData","gkx"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d,e){this.entityType=a,this.entityID=b,this.subscriptionID=c,this.shouldLog=this.$1(),this.sequenceID=0,this.appID=d,this.eventSource=e}var c=a.prototype;c.logEnter=function(a){this.shouldLog&&this.$2().setAction("enter").setSequenceID(++this.sequenceID).setCapabilities(a).log()};c.logReconnect=function(a){this.shouldLog&&this.$2().setAction("enter").setActionReason("reconnect").setSequenceID(++this.sequenceID).setCapabilities(a).log()};c.logSubscribeCallback=function(a){this.shouldLog&&this.$2().setAction("subscribe_completed").setActionReason(a?"succeeded":"failed").log()};c.logPing=function(){this.shouldLog&&this.$2().setAction("ping").setSequenceID(++this.sequenceID).log()};c.logSkippedPing=function(){this.shouldLog&&this.$2().setAction("skipped_ping").setSequenceID(this.sequenceID).log()};c.logChangeCapabilities=function(a){this.shouldLog&&this.$2().setAction("change_capabilities").setSequenceID(++this.sequenceID).setCapabilities(a).log()};c.logLeave=function(){this.shouldLog&&this.$2().setAction("leave").setSequenceID(++this.sequenceID).log()};c.logFlowStatus=function(a){if(this.shouldLog){var c="unknown";switch(a){case b("BladeRunnerTypes").StreamStatus.ACCEPTED:c="accepted";break;case b("BladeRunnerTypes").StreamStatus.REJECTED:c="rejected";break;case b("BladeRunnerTypes").StreamStatus.STARTED:c="started";break;case b("BladeRunnerTypes").StreamStatus.PAUSED:c="paused";break;case b("BladeRunnerTypes").StreamStatus.CLOSED:c="closed";break}this.$2().setAction("flow_"+c).log()}};c.logUnsubscribeCallback=function(a){this.shouldLog&&this.$2().setAction("unsubscribe_completed").setActionReason(a?"succeeded":"failed").log()};c.getLogInfo=function(){return this.shouldLog?{client_subscription_id:this.subscriptionID,sequence_id:this.sequenceID.toString()}:null};c.getLogInfoMQTT=function(){return this.shouldLog?{clientSubscriptionId:this.subscriptionID,sequenceId:this.sequenceID}:null};c.$1=function(){if(b("gkx")("678741"))return!0;return b("gkx")("678742")?b("Random").random()<(Object.prototype.hasOwnProperty.call(b("EntityPresenceConfig").samplingRateOverride,this.entityType)?b("EntityPresenceConfig").samplingRateOverride[this.entityType]:b("EntityPresenceConfig").sessionLoggingSamplingRate):!1};c.$2=function(){return new(b("RealtimeEntityPresenceTypedLogger"))().setEntityType(this.entityType).setEntityID(this.entityID).setClientSubscriptionID(this.subscriptionID).setClientTimeMs(Date.now()).setEventSource(this.eventSource).setAppID(this.appID).setUserFbid(b("CurrentUser").getID()).setUserAgentString(b("UserAgentData").browserName+"/"+(b("UserAgentData").browserFullVersion||""))};return a}();e.exports=a}),null);
__d("EntityPresenceClient",["BanzaiODS","BladeRunnerClient","BladeRunnerStreamHandler","BladeRunnerTypes","EntityPresenceLogger","UserActivity","clearInterval","gkx","setInterval","uuid"],(function(a,b,c,d,e,f){"use strict";var g=new(b("BladeRunnerClient"))(),h="219994525426954",i="ep_client",j="realtime.entity_presence.js_client";a={enter:function(a,c,d){var e=b("uuid")(),f=new(b("EntityPresenceLogger"))(a,c,e,h,i);f.logEnter(d);b("BanzaiODS").bumpEntityKey(3291,j,a+".enter");var k=g.requestStream({method:"EntityPresence"},JSON.stringify({entity_type:a,entity_id:c,capabilities:d,log_info:f.getLogInfo()}),new(b("BladeRunnerStreamHandler"))(null,null,function(a){f.logFlowStatus(a)},null)),l=null,m=null;b("gkx")("1375121")&&(m=new(b("EntityPresenceLogger"))("shadow",c,e+"_shadow",h,i),m.logEnter(),l=g.requestStream({method:"EntityPresence"},JSON.stringify({entity_type:"shadow",entity_id:c,log_info:m.getLogInfo()}),new(b("BladeRunnerStreamHandler"))()));var n=b("setInterval")(function(){b("UserActivity").isOnTab()&&k.getStatus()==b("BladeRunnerTypes").StreamStatus.STARTED?(f.logPing(),k.amendFireAndForget("")):f.logSkippedPing()},3e3);return{entityID:c,capabilities:d,changeCapabilities:function(c){f.logChangeCapabilities(c);b("BanzaiODS").bumpEntityKey(3291,j,a+".change_capabilities");return k.amendWithAck(JSON.stringify({capabilities:c}))},leave:function(){var c;(c=l)==null?void 0:c.cancel();(c=m)==null?void 0:c.logLeave();f.logLeave();b("BanzaiODS").bumpEntityKey(3291,j,a+".leave");k.cancel();b("clearInterval")(n)}}}};e.exports=a}),null);
__d("DocumentFocusForAdsVideoAutoplayRule",["VideoAutoplayRule","VideoPlayerShakaGlobalConfig"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(b){return a.call(this,b)||this}var d=c.prototype;d.calculateAutoplayScore=function(){return this.isEnabled()?this.$DocumentFocusForAdsVideoAutoplayRule1():1};d.$DocumentFocusForAdsVideoAutoplayRule1=function(){var a=this.videoUnit.getVideoPlayerController();a=!!(a&&a.isAd());var c=b("VideoPlayerShakaGlobalConfig").getBool("pause_videos_on_backgrounded",!1);return c||a?document.hasFocus()?1:0:1};return c}(b("VideoAutoplayRule"));e.exports=a}),null);
__d("FeedVideoClickToPlayController",["DocumentFocusForAdsVideoAutoplayRule","Event","VideoPlayerAbortLoadingExperiment","VideoPlayerExperiments","VideoPlayerShakaGlobalConfig","destroyOnUnload","setImmediate","throttle"],(function(a,b,c,d,e,f){var g=null;a=function(){"use strict";function a(){var a=this;this.$4=new Set();this.$3=null;this.$2=null;this.$1=null;b("destroyOnUnload")(function(){a.$4.clear(),a.$2&&(a.$2.remove(),a.$2=null),a.$3&&(a.$3.disconnect(),a.$3=null),a.$1&&(a.$1.remove(),a.$1=null),a===g&&(g=null)})}var c=a.prototype;c.addVideoUnit=function(a){var c=this;if(b("VideoPlayerShakaGlobalConfig").getBool("pause_videos_on_backgrounded",!1)||b("VideoPlayerExperiments").useBringYourOwnAutoplayRule&&b("VideoPlayerExperiments").pauseAdIfNoDocumentFocus){var d=new(b("DocumentFocusForAdsVideoAutoplayRule"))(a);a.registerAutoplayRule(d)}this.$5()||this.$6();this.$7()||this.$8();a.addListener("beginPlayback",function(b){b=b.reason;(b==="user_initiated"||b==="loop_initiated")&&c.$4.add(a)});a.addListener("turnOffAutoplay",function(b){b=b.reason;b==="unmuted"&&c.$4.add(a)});a.getVideoPlayerController().isState("playing")&&!a.isAutoplayable()&&this.$4.add(a);a.addListener("pausePlayback",function(){c.$4["delete"](a)});a.addListener("finishPlayback",function(){c.$4["delete"](a)})};a.registerVideoUnit=function(b){g==null&&(g=new a()),g.addVideoUnit(b)};c.$6=function(){this.$2&&this.$2.remove(),this.$2=b("Event").listen(window,"scroll",b("throttle")(this.onWindowEvent.bind(this),200))};c.$8=function(){this.$1&&this.$1.remove(),this.$1=b("Event").listen(window,"resize",b("throttle")(this.onWindowEvent.bind(this),200))};c.$5=function(){return!!this.$2};c.$7=function(){return!!this.$1};c.$9=function(a){a.pause("autoplay_initiated"),!b("VideoPlayerExperiments").noAbortLoadingInFeedClickToPlay&&b("VideoPlayerAbortLoadingExperiment").canAbort&&a.abortLoading(),this.$4["delete"](a)};c.onWindowEvent=function(){var a=this;this.$4.forEach(function(c){if(c&&!c.isVisible()&&!c.getIsInChannel()){var d=c.getVideoPlayerController();d.isAd()||b("VideoPlayerExperiments").pauseWhenOffscreen?b("VideoPlayerExperiments").slidingWNSv3?b("setImmediate")(function(){c&&!c.isVisible()&&!c.getIsInChannel()&&a.$9(c)}):a.$9(c):d.isMuted()&&d.isState("playing")&&(a.$9(c),d.emit("resumeAutoplay"))}})};return a}();e.exports=a}),null);
__d("VideoVODCVCSubscription",["EntityPresenceClient","Int64","Run","SubscriptionsHandler","gkx"],(function(a,b,c,d,e,f){"use strict";var g=42,h=7,i=5;a=function(){function a(a){var c=this;this.$7=function(){c.$5=null,c.$4&&(c.$4&&c.$4.leave(),c.$4=null)};if(a.isAd()||a.isLiveVideo())return;this.$1=new(b("SubscriptionsHandler"))();this.$4=null;this.$2=a;this.$3=this.$2.getPlayerOrigin();this.$5=null;this.$1.addSubscriptions(a.addListener("beginPlayback",function(){c.$5=null}),a.addListener("updateStatus",function(a){c.$2.isState("playing")&&(c.$5===null&&(c.$5=a.position),c.$5+3<=a.position&&(c.$5=Infinity,c.$6()))}),a.addListener("pausePlayback",this.$7),a.addListener("finishPlayback",function(){return!a.getOption("Looping","isLooping")&&c.$7()}),a.addListener("becomeInvisible",this.$7),a.addListener("seekEnd",this.$7),a.addListener("TahoeController/exitTahoe",this.$7));b("Run").onLeave(function(){return c.cleanOnLeave()})}var c=a.prototype;c.cleanOnLeave=function(){this.$7(),this.$1&&this.$1.release()};c.$6=function(){if(this.$4)return;this.$4=b("EntityPresenceClient").enter("vod",this.$2.getVideoID(),this.getLoggingCapabilitiesForEntityPresence().toString())};c.getLoggingCapabilitiesForEntityPresence=function(){var a,c;(a=b("Int64")).fromInt(0);c=a.fromString(Date.now().toString());var d=7;c=c.shiftLeft(d);c=c.add(a.fromInt(1));d=64-(g+h+i+d);c=c.shiftLeft(d);c=c.shiftLeft(i);c=c.add(a.fromInt(this.mapPlayerFormatToCapabilityBits(this.$2.getPlayerFormat())));c=c.shiftLeft(h);c=c.add(a.fromInt(this.mapPlayerOriginToCapabilityBits(this.$3)));return c};c.mapPlayerOriginToCapabilityBits=function(a){if(a===null)return 0;switch(a){case"commerce":return 12;case"direct_inbox":return 4;case"events":return 18;case"explorefeed":return 19;case"fb_stories":return 5;case"group":return 11;case"instant_articles":return 16;case"instant_shopping":return 16;case"live_chaining":return 22;case"living_room":return 9;case"living_room_recap":return 8;case"media_gallery":return 3;case"movie_checkout_flow":return 21;case"newsfeed":return 13;case"notifications":return 7;case"page_timeline":return 17;case"permalink":return 15;case"photosfeed":return 14;case"saved":return 23;case"search":return 20;case"top_live_bookmark":return 1;case"user_timeline":return 24;case"video_home":return 2;case"unknown":default:return 0}};c.mapPlayerFormatToCapabilityBits=function(a){if(a===null)return 0;switch(a){case"inline":return 1;case"snowlift":return 2;case"permalink":return 3;case"channel":return 4;case"full_screen":return 5;case"social_player":return 6;case"tv":return 7;case"misc":return 8;case"watch_scroll":return 9;case"watch_scroll_app_background":return 10;case"watch_and_go":return 11;case"watch_and_browse":return 12;case"canvas":return 13;case"tahoe":return 14;case"fb_stories":return 15;default:return 0}};return a}();e.exports=a}),null);